% !TeX spellcheck = en-US
% !TeX encoding = utf8
% !TeX program = pdflatex
% !BIB program = biber
% -*- coding:utf-8 mod:LaTeX -*-


% vv  scroll down to line 200 for content  vv


\let\ifdeutsch\iffalse
\let\ifenglisch\iftrue
\input{pre-documentclass}
\documentclass[
  % fontsize=11pt is the standard
  a4paper,  % Standard format - only KOMAScript uses paper=a4 - https://tex.stackexchange.com/a/61044/9075
  twoside,  % we are optimizing for both screen and two-side printing. So the page numbers will jump, but the content is configured to stay in the middle (by using the geometry package)
  bibliography=totoc,
  %               idxtotoc,   %Index ins Inhaltsverzeichnis
  %               liststotoc, %List of X ins Inhaltsverzeichnis, mit liststotocnumbered werden die Abbildungsverzeichnisse nummeriert
  headsepline,
  cleardoublepage=empty,
  parskip=half,
  %               draft    % um zu sehen, wo noch nachgebessert werden muss - wichtig, da Bindungskorrektur mit drin
  draft=false
]{scrbook}
\input{config}


\usepackage[
  title={A Tool for the Estimation of Lattice Parameters},
  author={Nicolai Krebs},
  type=bachelor,
  institute=sec, % or other institute names - or just a plain string using {Demo\\Demo...}
  course={Informatik, B.Sc.},
  examiner={Prof.\ Dr.\ Ralf Küsters},
  supervisor={Marc Rivinius,\ M.Sc.},
  startdate={April 22, 2021},
  enddate={October 22, 2021}
]{scientific-thesis-cover}

\input{acronyms}

\makeindex

\begin{document}

%tex4ht-Konvertierung verschönern
\iftex4ht
  % tell tex4ht to create picures also for formulas starting with '$'
  % WARNING: a tex4ht run now takes forever!
  %\Configure{$}{\PicMath}{\EndPicMath}{}
  %$ % <- syntax highlighting fix for emacs
  \Css{body {text-align:justify;}}

  %conversion of .pdf to .png
  \Configure{graphics*}
  {pdf}
  {\Needs{"convert \csname Gin@base\endcsname.pdf
      \csname Gin@base\endcsname.png"}%
    \Picture[pict]{\csname Gin@base\endcsname.png}%
  }
\fi

%\VerbatimFootnotes %verbatim text in Fußnoten erlauben. Geht normalerweise nicht.

\input{commands}
\pagenumbering{arabic}
\Titelblatt

%Eigener Seitenstil fuer die Kurzfassung und das Inhaltsverzeichnis
\deftriplepagestyle{preamble}{}{}{}{}{}{\pagemark}
%Doku zu deftriplepagestyle: scrguide.pdf
\pagestyle{preamble}
\renewcommand*{\chapterpagestyle}{preamble}



%Kurzfassung / abstract
%auch im Stil vom Inhaltsverzeichnis
\ifdeutsch
  \section*{Kurzfassung}
\else
  \section*{Abstract}
\fi

<Short summary of the thesis>

\cleardoublepage


% BEGIN: Verzeichnisse

\iftex4ht
\else
  \microtypesetup{protrusion=false}
\fi

%%%
% Literaturverzeichnis ins TOC mit aufnehmen, aber nur wenn nichts anderes mehr hilft!
% \addcontentsline{toc}{chapter}{Literaturverzeichnis}
%
% oder zB
%\addcontentsline{toc}{section}{Abkürzungsverzeichnis}
%
%%%

%Produce table of contents
%
%In case you have trouble with headings reaching into the page numbers, enable the following three lines.
%Hint by http://golatex.de/inhaltsverzeichnis-schreibt-ueber-rand-t3106.html
%
%\makeatletter
%\renewcommand{\@pnumwidth}{2em}
%\makeatother
%
\tableofcontents

% Bei einem ungünstigen Seitenumbruch im Inhaltsverzeichnis, kann dieser mit
% \addtocontents{toc}{\protect\newpage}
% an der passenden Stelle im Fließtext erzwungen werden.

\listoffigures
\listoftables

%Wird nur bei Verwendung von der lstlisting-Umgebung mit dem "caption"-Parameter benoetigt
%\lstlistoflistings
%ansonsten:
\ifdeutsch
  \listof{Listing}{Verzeichnis der Listings}
\else
  \listof{Listing}{List of Listings}
\fi

%mittels \newfloat wurde die Algorithmus-Gleitumgebung definiert.
%Mit folgendem Befehl werden alle floats dieses Typs ausgegeben
\ifdeutsch
  \listof{Algorithmus}{Verzeichnis der Algorithmen}
\else
  \listof{Algorithmus}{List of Algorithms}
\fi
%\listofalgorithms %Ist nur für Algorithmen, die mittels \begin{algorithm} umschlossen werden, nötig

% Abkürzungsverzeichnis
\printnoidxglossaries

\iftex4ht
\else
  %Optischen Randausgleich und Grauwertkorrektur wieder aktivieren
  \microtypesetup{protrusion=true}
\fi

% END: Verzeichnisse


% Headline and footline
\renewcommand*{\chapterpagestyle}{scrplain}
\pagestyle{scrheadings}
\pagestyle{scrheadings}
\ihead[]{}
\chead[]{}
\ohead[]{\headmark}
\cfoot[]{}
\ofoot[\usekomafont{pagenumber}\thepage]{\usekomafont{pagenumber}\thepage}
\ifoot[]{}


%% vv  scroll down for content  vv %%































%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Main content starts here
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Introduction}

- rise of quantum computing (short history)

  * conceptual

  * reality


- problem: some hard classical problems no longer hard

  * Shor's Algorithm (Peter Shor, 1994) %Sho97
    => quantum computers can solve the factoring and the discrete logarithm problem in polynomial time

  * application to encryption

  * overview of current encryption methods that will become insecure


- one solution (among hash-based, code-based, isogeny-based, and multivariate): lattice crypto

  * overview over history and capability of lattice crypto

  * advantages: good (quasilinear) asymptotic key sized, good concrete runtimes and key sizes, worst-case secure instantiations, advanced cryptographic primitives previously infeasible

  * including intro to LWE/SIS and applications to build crypto systems

    . SIS: signature schemes, hash functions

    . LWE: ``cryptomania'' applications (PKE, ...), signature schemes, lines:

      - cryptographic applications

      - establishing theoretical and asymptotic hardness \cite{Reg05} % ? Check
        \cite{BLPRS13, MP13} 
      - concrete hardness of LWE: attacks, runtime estimates, 

  * briefly outline concept and benefits of hard-case to average-case reductions


- purpose of this thesis

  * building schemes: need realistic hardness estimates of schemes for given parameter settings

  * lack in the past: no unified/easy to use tool => thesis aims to solve this problem
    tool we call \textit{Lattice Parameter Estimation} 
    LWE instances are estimated by calling various estimation functions from the LWE Estimator \cite{APS15}, which we will refer to as \textit{Estimator}.


- overview of chapters/how to read



\chapter{Preliminaries} \label{chap:Preliminaries}

\section{Notation}
In the following, we denote vectors by bold lower-case letters like $\mathbf{v}$ and matrices by bold upper-case letters $\mathbf{M}$. Unless specified otherwise, $\| \cdot \|$ is the Euclidean norm. By $[n]$ we denote the set $\{1, \dots, n\}$ for $n\in \mathbb{Z}^+$. With a slight abuse of notation, we interchangably use matrices and sets of column vectors, i.e. $\mathbf{M} = \left[\mathbf{v}_1 \cdots \mathbf{v}_n\right] = \left\{\mathbf{v}_1, \dots, \mathbf{v}_n\right\}$. 
% TODO: anything else? Inner product, negation in ring


\section{Math} 
% TODO: check out MG02 for more details for this section!!!

% TODO: some algebraic background?
\subsection{Norms and Bounds} % TODO: check
%TODO: write some prose about why we need that
Let $\mathcal{R}_q$ be a ring as defined in \cite{BDLOP18} and $f \in \mathcal{R}_q$ with $f = \sum_i f_i X^i$. We define the following norms \cite{BDLOP18}:
\begin{align}
  \ell_1 : \| f| \|_1 &= \sum_i |f_i|\\
  \ell_2 : \| f| \|_2 &= \left(\sum_i |f_i|^2\right) ^{\frac{1}{2}}\\
  \ell_\infty : \| f| \|_\infty &= \max_i |f_i|
\end{align}

Then the following inequations hold \cite{BDLOP18}:
\begin{align}
  \| f \|_1 &\leq \sqrt{n} \| f \|_2 \label{norm1}\\
  \| f \|_1 &\leq n \| f \|_\infty \label{norm2}\\
  \| f \|_2 &\leq \sqrt{n} \| f \|_\infty \;\;(\text{since }  \sqrt{n} \| f \|_2 \leq n \| f \|_\infty) \label{norm3}\\
  \| f \|_\infty& \leq \| f \|_1 \label{norm4}
\end{align}

Let $\mathcal{O}_K$ be the ring of integers of a number field $K=\mathbb{Q}(\theta)$, where $\theta$ is an algebraic number and $\sigma$ denote the canonical embedding as defined in \cite{DPSZ12}. Then, for $x, y \in \mathcal{O}_K$ it holds the following inequations hold (we assume that $C_m$ in \cite{DPSZ12} is $1$) \cite{DPSZ12}. 
\begin{align}
  \| f \|_\infty &\leq \| \sigma(f) \|_\infty \label{norm5}\\
  \| \sigma(f) \|_\infty &\leq \| f \|_1 \label{norm6}
\end{align}

From the above inequations, we obtain the following norm transformations to $\ell_p$-norms:
\begin{itemize}
  \item From \cref{norm1}, it follows that $\| f \|_1 \leq \sqrt{n} \| f \|_2$ and from \cref{norm2}, $\| f \|_1 \leq n \| f \|_\infty$.
  \item From \cref{norm3} and \cref{norm4}, it follows that $\| f \|_2 \leq \sqrt{n}  \| f \|_1$ and from \cref{norm3}, $\| f \|_2 \leq \sqrt{n}  \| f \|_\infty$.
  \item From \cref{norm4}, it follows that $\| f \|_\infty \leq  \| f \|_1$ and from \cref{norm1} and \cref{norm4}, $\| f \|_\infty \leq \sqrt{n}  \| f \|_2$.
  \item From \cref{norm6}, it follows that $\| \sigma(f) \|_\infty \leq  \| f \|_1$, from \cref{norm1} and \cref{norm6}, $\| \sigma(f) \|_\infty \leq \sqrt{n}  \| f \|_2$, and from \cref{norm2} and \cref{norm6}, $\| \sigma(f) \|_\infty \leq n  \| f \|_\infty$.
\end{itemize}

Likewise, we get the following transformations to the $\mathcal{C}_\infty$-norm:
\begin{itemize}
  \item From \cref{norm2} and \cref{norm5}, it follows that $\| f \|_1 \leq  n \| \sigma(f) \|_\infty$.
  \item From \cref{norm3} and \cref{norm5}, it follows that $\| f \|_2 \leq  \sqrt{n} \| \sigma(f) \|_\infty$.
  \item From \cref{norm5}, it follows that $\| f \|_\infty \leq  \| \sigma(f) \|_\infty$.
\end{itemize}

Let $f$ be defined as above and let $g \in \mathcal{R}_q$ where $g = \sum_i \overline{g}_i X^i$ where $g_i \in \left[-(q-1)/2, (q-1)/2\right]$ and $\overline{g}_i = g_i \mod q$ as in \cite{BDLOP18}. Then, we can define the following inequations for multiplication according to \cite{BDLOP18}:

\begin{itemize}
  \item If $\|f\|_\infty \leq \beta, \|g\|_1 \leq \gamma$ then $\|f \cdot g\|_\infty \leq \beta \cdot \gamma$.
  \item If $\|f\|_2 \leq \beta, \|g\|_2 \leq \gamma$ then $\|f \cdot g\|_\infty \leq \beta \cdot \gamma$.
\end{itemize}

Let $x, y \in \mathcal{O}_K$. Again, we assume that $C_m = 1$. Then, the following inequation holds according to \cite{DPSZ12}:
\begin{align}
  \| x \cdot y \|_\infty \leq C_m \cdot n^2 \cdot \| x \|_\infty \cdot \| y \|_\infty\\
  \| \sigma(x \cdot y) \|_\infty \leq  \| \sigma(x) \|_\infty \cdot \| \sigma(y) \|_\infty.
\end{align}



\subsection{lattice}
- background and history: example from lecture -> change % TODO: from lecture -> change!!!

  * Birhoff [Bir40]

  * cryptoanalysis [LLL82]

  * cryptosystems [Ajt96, HPS98]
    SIS introduced Ajtai \cite{Ajt96}

  * [MR04]

  * LWE, assumption: worst-case lattice problems are hard [Reg05]

  * fully homomorphic [Gen09]

  * BGV scheme [BV11, BGV12]

  * tools [LPR10, LPR13] ideal latties, RLWE

Other Notes: %TODO
- PKE \cite{AD97, Reg03, Reg05}, CCA security \cite{PW08, Pei09}, identity-based encryption \cite{GPV08, CHKP10, ABB10}, fully homomorphic \cite{Gen09a}
- , LWE introduced by \cite{Reg05} "provably as hard as certain lattice problems in worst case, appear to require time exponential in main security parameter to solve"
- NTRU \cite{HPS98}
- $q$-ary lattice: modulus $q\geq 2$

- math % TODO: rewrite or \cite{Gop16}
  * lattice $\Lambda$ % TODO: check all n/m's

    

    - discrete additive subgroup of $\mathbb{R}^m$ % define discrete and additive subgroup?

    - Let $\mathbf{b}_1, \ldots, \mathbf{b}_n \in \mathbb{R}^m$ be a set of linearly independent basis vectors and $\mathbf{B} = \left[\mathbf{b}_1, \ldots, \mathbf{b}_n\right] \in \mathbb{R}^{m\times n}$ be the corresponding basis with column vectors $\mathbf{b}_i$

    - $n$ is the dimension of the Lattice

    - $\Lambda(\mathbf{B})$ defined by all integer combinations of elements of $\mathbf{B}$:
    \begin{equation}
      \Lambda(\mathbf{B}) = \left\{ x \in \mathbb{R}^m \mid \exists \alpha_1, \ldots, \alpha_n \in \mathbb{Z} : \mathbf{x} = \sum_{i=1}^n \alpha_i \mathbf{b}_i \right\}
    \end{equation} 
    - show example plot % TODO

    - full-ranked lattice: dimension is maximal, $m$

    - basis $\mathbf{B}$ is not unique -> let $\mathbf{U}\in \mathbb{Z}^{n\times n}$ be a modular matrix (determinant is $\pm1$), then $\mathbf{B}\cdot \mathbf{U}$ is also a basis of the $\Lambda$ ($\mathbf{U} \cdot \mathbb{Z}^{n} = \mathbb{Z}^{n}$) -> different basis for the same lattice $\Lambda$

    - lattice coset:
      quotient group $\mathbb{R}^n/\Lambda$ of cosets
      \begin{equation*}
        \mathbf{c} + \Lambda = {\mathbf{c} + \mathbf{v} \mid v \in \Lambda}
      \end{equation*}
      with $\mathbf{c} \in \mathbb{R}^n$ % TODO: maybe add plot

    - fundamental domain: subset of $\mathbb{R}^m$ containing exactly one representative of every coset

    - (shifted) fundamental parallelipiped \label{eq:fundamental-parallelipiped}: $\mathcal{P}(\mathbf{B}) = \mathbf{B} \cdot [ - 1/2, 1/2)^n = \left\{ \mathbf{x} \in \mathbb{R}^m \mid \mathbf{x} \sum_{i=1}^n \gamma_i \mathbf{x}_i, \gamma_i \in  [ - 1/2, 1/2) \right\}$ every coset has representative  % c - B * \left\lfloor^{-1} \cdot c\right\rceil
    % TODO: first define [0, 1)
    % intuition: collection of all points that can be written as By where y in [0, 1)^n
    % TODO: maybe add plot

    - determinant of lattice $\Lambda(\mathbf{B})$: $\sqrt{\text{det}\left(\mathbf{B}^\intercal \mathbf{B}\right)}$. For a full-ranked lattice the determinant is 
    \begin{equation}
      \det(\Lambda(\mathbf{B})) = |\det(\mathbf{B})|
    \end{equation}
      is well-defined (independent from basis) => volume of fundamental domain % TODO define
      can be generalized to not full-ranked => $\det(\Lambda(\mathbf{A})) = \sqrt{\det(\mathbf{A}^\perp \mathbf{A})}$ % TODO perp

  * minimum distance of $\lambda_1(\Lambda)$ of a lattice is the length of its shortest nonzero vector, i.e. $\lambda_1(\Lambda) \min_{v \in \Lambda \setminus \{0\}}$
  * $i$th successive minimum $\lambda_i(\Lambda)$
    - Let $r\in \mathbb{R}$ and $\mathbf{c} \in \mathbb{R}^m$, then we define $\mathcal{B}(\mathbf{c}, r)$ as the ball of radius $r$ with center $\mathbf{c}$. 

    - smallest radius $r$ such that the ball $\mathcal{B}(\mathbf{0}, r)$ centered at the origin of $\Lambda$ contains $i$ linearly independent lattice vectors. 

    - in general hard to calculate $\lambda_i(\Lambda(\mathbf{B}))$ for a given basis  
  % * Gaussian heuristic: 
  %   - estimate length of shortest lattice vactor in $n$-dimensional lattice $Lambda$, i.e. estimate $\lambda_1(\Lambda)$ given $\det{\Lambda}$
  %   \begin{equation}
  %     \lambda_1{\Lambda} \approx \frac{\Gamma(1 + n/2)^{1/n}}{\sqrt{\pi}} \det(\Lambda)^{1/n}
  %   \end{equation}
  
  * modular integer (or $q$-ary) lattices % \cite{MR09}

    - full-ranked lattice $\Lambda$ such that $q\mathbb{Z}^m \subseteq	\Lambda \subseteq	\mathbb{Z}^m$ given $q \in \mathbb{N}$ => if $\mathbf{x} \in \mathbb{Z}^m$ in $\Lambda$ then $\mathbf{x} \mod q$ also in $\Lambda$. 

    - can be specified in two ways by matrix $\mathbf{A} \in \mathbb{Z}_q^{m\times n}$: % TTODO switch m and n for consistency
    \begin{equation}
      \Lambda_q(\mathbf{A}) = \left\{ x \in \mathbb{Z}^m \mid \exists y \in \mathbb{Z}^n : \mathbf{x} = \mathbf{A}\mathbf{y} \mod q \right\}
    \end{equation}
    % TODO: corresponds to linear code generated by columns of A (mod q)
    or
    \begin{equation}
      \Lambda_q^\perp(\mathbf{A}) = \left\{ x \in \mathbb{Z}^m \mid  \mathbf{A}^\intercal\mathbf{x} = 0 \mod q \right\}
    \end{equation}

    - finding a short vector in $\Lambda_q(\mathbf{A})$ corresponds to LWE % TODO check

    - finding short vectors in $\Lambda_q^\perp(\mathbf{A})$ corresponds to SIS % TODO check \cite{Reg10}

    - easy to find basis of $\Lambda_q(\mathbf{A})$ \cite{AFG13}

    - with high probability determinant of $q$-ary lattice is $\det(\Lambda_q(\mathbf{A}))=q^{m-n}$ if $\mathbf{A} \in \mathbb{Z}_q^{m\times n}$


  * Gram-Schmidt basis

    - set of column vectors $\mathbf{B} \in \mathbb{Z}_q^{m\times n}$, $\pi_{\text{span}(\mathbf{B})}(\mathbf{t})$ for projection of vector $\mathbf{t}$ unto span of vectors of $\mathbf{B}$

    - $\pi_{\text{span}(\mathbf{B})}(\mathbf{t}) = \mathbf{B}(\mathbf{B}^\perp \mathbf{B})^{-1}\mathbf{B}^\intercal \cdot \mathbf{t}$

    - Gram-Schmidt orthogonalization $\tilde{\mathbf{B}} = \left[\tilde{\mathbf{b}}_1 \cdots \tilde{\mathbf{b}}_n\right]$ of basis $\mathbf{B}$: $\tilde{\mathbf{b}}_i = \mathbf{b}_i - \pi_{\text{span}(\mathbf{b}_1, \ldots, \mathbf{b}_{i-1})}(\mathbf{b}_i)$ for $i \in \{1, \ldots, n\}$ 

    - Gram-schmidt coefficients $\mu_{i, j} = \frac{\left\langle \tilde{\mathbf{b}}_j, \mathbf{b}_i\right\rangle}{\left\langle \tilde{\mathbf{b}}_j, \tilde{\mathbf{b}}_j\right\rangle}$ %Pla18

    Alternative:
    Let $\mathbf{B} = \left[\mathbf{b}_1 \cdots \mathbf{b}_n\right], \mathbf{b}_i \in \mathbb{Z}_q^{m}$ be a basis. Define $\tilde{\mathbf{b}}_i$ as follows: $\tilde{\mathbf{b}}_1 = \mathbf{b}_1$. For $i \in \{2, \ldots, n\}$ let $\tilde{\mathbf{b}}_i$ be the component of $\mathbf{b}_i$ that is orthogonal to the span of $\left\{\mathbf{b}_1, \ldots, \mathbf{b}_{i-1}\right\}$. Then,  $\tilde{\mathbf{B}} = \left[\tilde{\mathbf{b}}_1 \cdots \tilde{\mathbf{b}}_n\right]$ is called the Gram-Schmidt orthogonalization of basis $\mathbf{B}$ where $\| \tilde{\mathbf{b}}_i\| \leq \| \mathbf{b}_i\|$. 
    % TODO Also check out algorithm from AGVW17

  
  * dual of a lattice is "the set of points whose inner products with the vectors in the lattice are integers" $\Lambda$: $\Lambda^{\perp} := \{ \mathbf{y} \in \mathbb{R}^m \mid \forall \mathbf{v} \in \Lambda: \langle \mathbf{y}, \mathbf{v} \rangle \in \mathbb{Z}\}$
    % TODO: show examples
    scaled-by-$q$ dual lattice:  $\{ \mathbf{y} \in \mathbb{Z}^m \mid \forall \mathbf{v} \in \Lambda: \langle \mathbf{y}, \mathbf{v} \rangle = 0 \mod q\}$ % not sure if needed
    
  * smoothing lemma

  * Voronoi region % \cite{GSJ15}
  The fundamental Voronoi region $\mathcal{V}$ is defined as 
  \begin{equation}
    \mathcal{V} = \left\{ \mathbf{x} \in \mathbb{R}^n \mid \forall \mathbf{y} \in \Lambda : \| \mathbf{x} \| \leq \| \mathbf{x} - \mathbf{y} \| \right\}
  \end{equation}

  * Linear Code \cite{VanLint12} % TODO maybe move to Coded BKW
    Let $\mathbb{F}_q^n$ be the $n$-dimensional vector space over the field $\mathbb{F}_q$. A $q$-ary linear code $\mathcal{C}$ or $[n, k]$-code is a $k$-dimensional linear subspace of $\mathbb{F}_q^n$ such that 
    \begin{itemize}
      \item $\mathbf{0} \in \mathcal{C}$,
      \item if $\mathbf{x}, \mathbf{y} \in \mathcal{C}$, then $\mathbf{x} + \mathbf{x} \in \mathcal{C}$,
      \item and if $\mathbf{x} \in \mathcal{C}$ and $\gamma \in \mathbb{F}_q$, then $\gamma \mathbf{x} \in \mathcal{C}$.
    \end{itemize}
    There are $q^k$ different codewords in $\mathcal{C}$.

    Let $\mathcal{C}$ be a $q$-ary linear $[n, k]$-code. The lattice over $\mathcal{C}$ is defined as % \cite{GJS15}
    \begin{equation}
      \Lambda(\mathcal{C}) = \left\{ \mathbf{x} \in \mathbb{R}^n \mid \exists \mathbf{y} \in \mathcal{C} : \mathbf{x} = \mathbf{y} \mod q  \right\}.
    \end{equation} % TODO check
    Similarly, for a lattice $\Lambda(\mathbf{B})$ a lattice code $\mathcal{C}$ defined by $\Lambda(\mathbf{B})$ and a shaping region $\mathcal{V} \subset \mathbb{R}^n$ (e.g. the Voronoi region) is a subspace of $\mathbb{R}^n$ such that all codewords are lattice vectors in $\Lambda(\mathbf{B})$ within the region $\mathcal{V}$ \cite{SFS08}:
    \begin{equation}
      C' = \left\{ x \in \Lambda(\mathbf{B}) \mid x \in \mathcal{V} \right\}.
    \end{equation} % TODO check


% TODO: where to put

    We define $\text{dist}(\mathbf{t}, \Lambda(\mathbf{B}))$ where $\Lambda(\mathbf{B}) \subset \mathbb{R}^m$ as the distance of a vector $\mathbf{t} \in \mathbb{R}^m$ to the closest lattice vector $\mathbf{v} \in \Lambda(\mathbf{B})$, i.e. 
    \begin{equation}\label{eq:dist}
      \text{dist}(\mathbf{t}, \Lambda(\mathbf{B})) = \min_{\mathbf{v} \in \Lambda(\mathbf{B})}\|\mathbf{t} -  \mathbf{v}\|.
    \end{equation}

    
    

- Lattice problems

  * Minkowski theorem: Let $\Lambda$ be a lattice of dimension $n$, then $\lambda_1 \leq \sqrt{n} \cdot (\det \Lambda)^{\frac{1}{n}}$

  * Lattice reduction: find short basis compared to $\lambda_1(\Lambda)$... 

  * SVP: given a basis $\mathbf{B}$ of lattice $\Lambda$ find shortest nonzero lattice vector =>  $v\in \Lambda$ s.t. $\| v \| = \lambda_1(\Lambda)$

\begin{definition}[$\gamma$-approximate Shortest Vector Problem (SVP$_\gamma$)] \label{def:gammaSVP} % TODO find source
  Given a basis $\mathbf{B}$ of lattice $\Lambda$, find a short lattice vector $v\in \Lambda$ such that $0 < \| v \| \leq \gamma \lambda_1(\Lambda)$
\end{definition}

\begin{definition}[$\kappa$-approximate Hermite Shortest Vector Problem (HSVP$_\kappa$)] \label{def:kappaHSVP} % TODO find source
  Given a basis $\mathbf{B}$ of a lattice $\Lambda(\mathbf{B}) \in \mathbb{R}^m$, find a nonzero lattice vector $\mathbf{v} \in \Lambda$ such that $\| \mathbf{v} \| \leq \kappa \cdot \text{det}(\Lambda)^{\frac{1}{n}}$. 
\end{definition}

  * \textsc{GapSVP}$_\gamma$ (decision version of \textsc{SVP}): "given basis $\mathbf{B}$ of $n$-dimensional lattice $\Lambda$ with either $\lambda_1{\Lambda} \leq 1$ or $\lambda_1{\Lambda} \geq \gamma(n)$, decide which is the case" %\cite{Pei16}
    NP hard for any constant $\gamma$ % Kho04, HR07 see LM09
    fastest algorithm for $1\leq \gamma \leq \text{poly}(n)$ has runtime complexity of $2^{O(n)}$
  
  * $\gamma$-unique Shortest Vector Problem (uSVP$_\gamma$) \cite{LM09}: given lattice $\Lambda$ such that $\lambda_2(\Lambda) > \gamma \lambda_1(\Lambda)$, find shortest nonzero vector in $\mathbf{v} \in \Lambda$ with $\|\mathbf{v}\| = \lambda_1(\Lambda)$
    % or more relaxed version $\|\mathbf{v}\| = \gamma\lambda_1(\Lambda)$
    %NP hard when $\gamma = 1 + 2^{-n^c}$ for some constant $c$ \cite{KS01}

  * CVP$_\gamma$: given  basis $\mathbf{B}$ of $n$-dimensional lattice $\Lambda$ and target $\mathbf{t}\in\mathbb{R}^n$ find point in lattice that is close to $\mathbf{t}$ => find  $\mathbf{v} \in \mathbb{R}^n$ with $\|\mathbf{t} - \mathbf{v}\| < \gamma \min_{\mathbf{v}' \in \Lambda} \|\mathbf{v}' - \mathbf{v}\|$

  * \textsc{SIVP} (shortest independent vector problem): given  basis $\mathbf{B}$ of $n$-dimensional lattice $\Lambda$, find $n$ linearly independent lattice vectors $\mathbf{v}_1, \ldots, \mathbf{v}_n \in \Lambda(\mathbf{B})$ such that $\max_i \|\mathbf{v}_i\|$ for $i \in \{1, \ldots, n\}$ is minimal

  * $\gamma$-Bounded Distance Decoding (BDD$_\gamma$): Given a lattice $\Lambda$ and a target vector $\mathbf{t}$ such that $\text{dist}(\mathbf{t}, \Lambda) < \gamma \lambda_1(\Lambda)$, find the closest lattice vector $\mathbf{v} \in \Lambda$, i.e. find $\mathbf{v} = \min_{\mathbf{v}' \in \Lambda} \|\mathbf{v}' - \mathbf{t}\|$ minimal \cite{LM09}
    % or more relaxed version: find closest vector $\mathbf{v} \in \Lambda$ such that $\|\mathbf{v} - \mathbf{t}\| < \gamma \lambda_1(\Lambda)$
    % alternate NP hard for $\gamma > 1/\sqrt{2}$ \cite{LLM06}

  % TODO: add some kind of discussion, e.g. see 1.2 in LM09 or better overview from bootcamp

  * ideal lattice (do I need that?)

  * ...?

  * eher die Sachen für LWE/SIS als die Sachen für Algorithmen (analog Vorlesung), evtl. 
  
  Intuition für die anderen Sachen...
  Solving SVP with approximation factors: % where to put???
        - 1 => NP-hard \cite{Ajt98}
        - $\tilde{O}(n)$ => OWF \cite{Ajt96, MR04}
        - $2^{n \log \log n / \log n}$ and $2^{n/2}$ in Poly-time \cite{LLL82}
        => best known $2^k$-approx in $2^{\tilde{O}(n/k)}$ time (even quantum!)


\subsection{distributions}

  - Gaussian, def, component-wise, trafo to bound % TODO: GPV08, or LS15

    * definition:
      discrete Gaussian distribution over $q$-ary lattice $\Lambda$ with Gaussian width parameter $s > 0$ and center $\mathbf{c}$, denoted by $D_{\Lambda, s, \mathbf{c}}$: probability of sampling a vector $\mathbf{x}\in \Lambda$ is proportional to $e^{-\pi \|\mathbf{x} - \mathbf{c}\|^2/s^2}$ % \cite{Reg10, GPV08} or "probability distribution that assigns mass proportional to ... to each point $\mathbf{x}\in \Lambda$"
      In order to avoid confusion, throughout this work and in the \textit{Lattice Parameter Estimation} we use $\sigma$ to denote the standard deviation, where $\sigma = \frac{s}{\sqrt{2 \pi}}$, and define $\alpha := \frac{s}{q} = \frac{\sqrt{2\pi} \sigma}{q}$. 

    * better definition in GPV08 => different definition needed for LWE??? % TODO
    * how to do this? => variant of Babai's ``nearest-plane'' algorithm, see \cite{GPV08} % TODO

    * component-wise
    

    For some applications, we receive a Gaussian distribution as input, but require a bound in some norm in order to estimate the hardness of SIS. Hence, we need to transform the Gaussian width parameter into a bound $\beta$ given some security parameter $\text{sec}$. Note that a $n$-dimensional Gaussian can be sampled by sampling $n$ independent 1-dimensional Gaussians. %TODO reformulate
        
    For a Gaussian distribution, the following holds: 
    
    \begin{equation}
      \text{Pr}\left[ |X| \geq \beta \right] \leq 2 e^{-\pi \beta^2/s^2}
    \end{equation}
    
    We demand $2 e^{-\pi \beta^2/s^2} \approx 2^{-sec}$, hence
    
    \begin{align*}
      2 e^{-\pi \beta^2/s^2} &\approx 2^{-sec}\\
      -\pi \frac{\beta^2}{s^2} &\approx (-sec - 1)\ln (2)\\
      \beta  &\approx s \sqrt{\frac{(sec + 1) \ln(2)}{\pi}}
    \end{align*}


    * smoothing factor here?

    * Uniform (stuff I use in tool)







\section{LWE and SIS}
Applications: SIS can be used for one-way functions and collision-resistant hasing. LWE can be used to build pseudo-random number generators, public-key encryption schemes and oblivious transfer and secure MPC. Lattice Trapdoors (trapdoor functions, digital signatures)? Punctured Trapdoors (identity-based encryption, attribute-based encryption, predicate encryption)? % TODO: from https://www.youtube.com/watch?v=LlPXfy6bKIY see below for more detail

\subsection{LWE}
Following based on \cite{Reg10}:% TODO: change or quote 

Introduced by Regev in \cite{Reg09}
Origin: work of Ajtai and Dwork \cite{AD97}, first public-key cryptosystem based on worst-case lattice problems, simlifications/improvements \cite{GGH97b, Reg03} imply hardness result for LWE. 
Early work: hardness based on unique-SVP, Peikert \cite{Pei09} and Lyubashevsky and Micciancio \cite{LM09} show that unique-SVP is essentially equivalent to \textsc{GapSVP}.

- ´cryptomania´ applications: public-key encryption schemes under chosen-plaintext attacks \cite{Reg05, KTX07, PVW08}, and chosen-ciphertext attacks \cite{PW08, Pei09}, oblivious transfer protocoles \cite{PVW08}, identity-based encryption (IBE) schemes \cite{GPV08, CHKP10, ABB10}, leakage-resilient encryption \cite{AGV09, ACPS09, DGKPV10, GKPV10}, and more % TODO change or \cite{Reg10}

- most important: fully homomorphic encryption schemes \cite{Gen09a, BV11, Bra12, GSW13} % TODO 

Intuition: 
- "recover $\mathbf{s} \in \mathbb{Z}_q^n$ given sequence of ´approximate´ random linear equations on $\mathbf{s}$" 
- public matrix  $\mathcal{A} \in \mathbb{Z}^{n \times m}$, secret vector $\mathcal{s}\in \mathbb{Z}^n$, given $\mathcal{z} = \mathcal{A}^\intercal \mathcal{s}$ we can find $\mathbf{s}$ by linear algebra
when we add a small error vector $\mathbf{e} \in \mathbb{Z}^m$, solving $\mathcal{z}' = \mathcal{A}^\intercal \mathcal{s} + \mathbf{e}$ for $\mathbf{s}$ or distinguishing $\mathbf{z}'$ from uniform becomes hard


Formal Definition: 
\begin{definition}[LWE Distribution \cite{Reg10}] %TODO
  For $n \geq 1$, modulus $q \geq 2$, error distribution $\chi$ on $\mathbb{Z}_q$, and a fixed secret vector $\mathbf{s}$, let $\mathcal{A}_{\mathbf{s}, \chi}$ be the probability distribution over $\mathbb{Z}_q^n \times \mathbb{Z}_q$ by choosing a vector $\mathbf{a}_i \in \mathbb{Z}_q^n$ uniformly at random, $e_i \in \mathbb{Z}_q$ according to $\chi$ and returning pairs of $(\mathbf{a}_i, \langle \mathbf{a}_i, \mathbf{s} \rangle + e_i \mod q) \in \mathbb{Z}_q^n \times \mathbb{Z}_q$.
\end{definition}

Additions are performed in $\mathbb{Z}_q$. We say that an algorithm solves LWE with modulus $q$ and error distribution $\chi$ if, for any $\mathbf{s} \in \mathbb{Z}_q^n$, given an arbitrary number of independent samples from $\mathcal{A}_{\mathbf{s}, \chi}$ it outputs $\mathbf{s}$ (with high probability). For $q=2$ corresponds to \textit{learning parity with noise} (LPN) problem. % TODO still needed with Search-LWE\ldots???

% TODO matrix Schreibweise vs nicht matrix schreibweise
% TODO Define Search/Decision LWE? 
\begin{definition}[Search-LWE$_{n, q, m, \chi}$] % \cite{LP11}
  Search-LWE$_{n, q, m, \chi}$ asks for the recovery of the secret vector $\mathbf{s}$ given $m$ independent samples $(\mathbf{a}_i, z_i) \leftarrow \mathcal{A}_{\mathbf{s}, \chi}$ % TODO matrix
\end{definition}

\begin{definition}[Decision-LWE$_{n, q, m, \chi}$]
  Given $m$ samples, Search-LWE$_{n, q, m, \chi}$ asks to distinguish whether the samples were drawn from  $\mathcal{A}_{\mathbf{s}, \chi}$ or from a uniform distribution on $\mathbb{Z}_q^n \times \mathbb{Z}_q$.
\end{definition}

% TODO: show more about decoding problem?
% TODO: Einheitsmatrix in notation
% TODO: notation \mathbf{x} = (x_1, \ldots, x_n) is column vector and  \mathbf{x}^\intercal its corresponding tranpose
% TODO: add somewhere we assume that m > n
\subsubsection{LWE as a Decoding Problem}
We request $m$ samples $(\mathbf{a}_1, z_1), \ldots, (\mathbf{a}_m, z_m)$ where $z_i = \langle \mathbf{a}_i, \mathbf{s} \rangle + e_i \in \mathbb{Z}_q$. Let $A = \left[ \mathbf{a}_1 \cdots \mathbf{a}_m\right]$, $\mathbf{z} = \left[z_1, \ldots, z_m\right]^\intercal$ and $e = \left[e_1, \ldots, e_n\right]^\intercal$. Hence, we can reformulate LWE as a decoding problem as in \cite{GJS15}:
\begin{equation} \label{eq:lwe-decoding}
  \mathbf{z} =  \mathbf{A}^\intercal \mathbf{s} + \mathbf{e}
\end{equation} % TODO duplicate???
with generator matrix $\mathbf{A}$ for a linear code over $\mathbb{Z}_q$ and $\mathbf{z}$ as the received word. Finding the secret vector $\mathbf{z}$ is equivalent to finding the codeword $\mathbf{y} = \mathbf{A}^\intercal\mathbf{s}$ with minimum distance $\| \mathbf{y} - \mathbf{z} \|$. 

An LWE$_{n, q, m, \chi}$ instance with a secret vector $\mathbf{s}$ chosen according to a uniform distribution can be transformed into an LWE$_{n, q, m-n, \chi}$ instance with a secret vector $\hat{\mathbf{s}}$ chosen according to the error distribution $\chi$ at a loss of $n$ samples as follows: Let $\mathbf{A}_0 = \left[ \mathbf{a}_1 \cdots \mathbf{a}_n\right]$ where $\mathbf{a}_1, \ldots, \mathbf{a}_n$ are the first $n$ columns of $\mathbf{A}$. We introduce new variables $\hat{\mathbf{s}} = \mathbf{A}^\intercal_0 \mathbf{s}  - \left[z_1, \ldots, z_n\right]^\intercal = \left[e_0, \ldots, e_n\right]^\intercal$ and $\hat{\mathbf{A}} = \mathbf{A}_0^{-1} \mathbf{A} = \left[\mathbf{I} \; \hat{\mathbf{a}}_{n+1} \cdots \hat{\mathbf{a}}_{m}\right]$ and compute $\hat{\mathbf{z}} = \mathbf{z} -  \hat{\mathbf{A}}^\intercal \left[z_1, \ldots, z_n\right]^\intercal  = \left[\mathbf{0}, \hat{z}_{n+1} \cdots \hat{z}_{m} \right]^\intercal$. 

% TODO parameter choice: often prime q \in poly(n), \chi has mean zero and \sigma = \alpha \cdot q for some small \alpha, e.g. Regev: q \approx n^2, \alpha = 1/(\sqrt{2\pi n} \cdot \log_2^2 n)

\subsubsection{LWE as a BDD Problem} \label{sec:lwe-bdd} % \cite{LP11}
Solving LWE also corresponds to solving the \textit{Bounded Distance Decoding problem} (BDD) in the lattice $\Lambda(\mathbf{A}^\intercal) = \{ \mathbf{x} \in \mathbb{Z}_q^m \mid \exists \mathbf{s} \in \mathbb{Z}_q^n : \mathbf{x} = \mathbf{A}^\intercal \mathbf{s}  \mod q \}$, where the $m$ columns of $\mathbf{A}$ correspond to the vectors $\mathbf{a}_i \in \mathbb{Z}_q^n$ of $m$ independent LWE samples $(\mathbf{a}_i, z_i) \leftarrow \mathcal{A}_{\mathbf{s}, \chi}$ and the components $z_i$ correspond to a perturbed lattice point in $\Lambda(\mathbf{A}^\intercal)$. % TODO check ^\intercal



Best algorithm to solve LWE: Blum, Kalai, and Wasserman \cite{BKW03} with $2^{O(n)}$ samples and time. % TODO Sketch BKW?

Hardness: best algorithm exponential, extension of LPN (LPN believed to be hard), hard assuming worst-case hardness of \textsc{GapSVP} % TODO make sure that is correct
and \textsc{SIVP} \cite{Reg05, Pei09}. More details? Different cases for $q$ exponential/polynomial, approximation factors...
Hardness based on worst-case lattice problems => strong security guarantees, such as conjectured security against quantum computers...
 
Search to decision reduction => distiguishing is LWE samples from uniform samples sufficient, worst-case to average-case reduction => sufficient to solve distinguishing for uniform secret

\subsection{Short Integer Solution (SIS)}
The dual problem to LWE is the \textit{Short Integer Solution problem} (SIS).

- principle: given a set of set of uniformly random vectors $\mathbf{a}_1, \ldots, \mathbf{a}_m \in \mathbb{Z}_q^n$ find a subset of them or combination with small coefficients that sums to zero (modulo $q$). % TODO change or \cite{Reg10}

- introduced in \cite{MR04}, origins in \cite{Ajt96}, used for ´minicrypt´ primitives: one-way functions \cite{Ajt96}, collision resistant hash functions \cite{GGH96}, digital signature schemes \cite{GPV08, CHKP10}, and identification schemes \cite{MV03, Lyu08, KTX07} % TODO change or \cite{Reg10}

\begin{definition}[SIS Problem (Adapted from [\citealp{LS15}, Definition 3.1])]
  The problem \text{SIS}$_{n, q, m, \beta}$ is defined as follows: Given a uniformly random matrix $\mathbf{A}^{n\times m}$, find a vector $\mathbf{s} \in \mathbb{Z}_q^m$ such that $\mathbf{A} \cdot \mathbf{s} = 0 \; \text{mod } q$ and $0 < \| \mathbf{s}\| \leq \beta$.
\end{definition}

Finding such a vector corresponds to finding a short lattice vector in costets of the lattice $\Lambda^{\perp}(\mathbf{A}) = \{ y \mid \mathbf{A} \cdot y \mod q \}$ % TODO get source other than https://www.youtube.com/watch?v=LlPXfy6bKIY

Hardness: for any poly-bounded $m, \beta$ and for ``large enough'' prime $q$: SIS$_{n, q, m, \beta}$ is as hard as worst-case approx-SIVP (and \textsc{GapSVP}) to within $\beta \cdot \tilde{O}(\sqrt{n})$ factor 

\subsection{Ring and Module Variants} 
- problem key sizes in LWE/SIS in $O(n^2)$ (matrix $\mathbf{A} \in \mathbb{Z}_q^{m \times n})$, where $m \in \Omega(n)$)% TODO change or \cite{Reg10}

- idea: introduce some sort of a structure in samples: $n$ power of two, $\mathbf{a}$ vectors in groups of size $n$, for each group $\mathbf{a}_1 = [a_1, \ldots, a_n]^\intercal$, $a_i$ are uniformly random in $\mathbb{Z}_q$, and $\mathbf{a}_i = [a_i, \ldots, a_n, -a_1, \ldots, -a_{i-1}]^\intercal$. Hence, $n$ vectors only need $O(n)$ memory, also speedups in operations by using FFT % TODO change or \cite{Reg10}

- formally: vectors are elements of the ring $\mathbb{Z}_q\left[x\right] / \left\langle x^n + 1 \right\rangle$ which we call $\mathcal{R}_q$ instead of the group $\mathbb{Z}_q^n$, $n$ power of two ensures that $x^n + 1$ is irreducible over the rationals% TODO change or \cite{Reg10}

- add more? % TODO

\begin{definition}[Ring-SIS Problem [\citealp{LS15}, Definition 3.3])]
  The problem \text{RSIS}$_{n, q, m, \beta}$ is defined as follows: Given $a_1, \ldots, a_n \in \mathcal{R}_q$ chosen independently from the uniform distribution, find $s_1, \ldots, s_n \in \mathcal{R}$ such that $\sum_{i=1}^m a_i \cdot s_i = 0 \mod q$ and $0 < \| \mathbf{s}\| \leq \beta$, where $\mathbf{s} = \left[s_1, \ldots, s_m\right]^\intercal \in \mathcal{R}^m$.
\end{definition} % TODO: need n? say sth more about n power of 2?
% TODO: matrix version?

\begin{definition}[Module-SIS Problem [\citealp{LS15}, Definition 3.3])]
  The problem \text{MSIS}$_{n, d, q, m, \beta}$ is defined as follows: Given $a_1, \ldots, a_n \in \mathcal{R}_q^d$ chosen independently from the uniform distribution, find $s_1, \ldots, s_n \in \mathcal{R}$ such that $\sum_{i=1}^m a_i \cdot s_i = 0\mod q$ and $0 < \| \mathbf{s}\| \leq \beta$, where $\mathbf{s} = \left[s_1, \ldots, s_m\right]^\intercal \in \mathcal{R}^m$.
\end{definition} % TODO: need n? say sth more about n power of 2?
% TODO: matrix version?

% TODO: LWE

While there exist special cases where the Ring structure of problem instances can be exploited in an attack on LWE or SIS, % TODO: find examples
in general, the hardness of Ring and Module variants is estimated by interpreting the coefficients of elements of $\mathcal{R}_q$ as vectors in $\mathbb{Z}_q^n$ \cite{ACDDPPVW18}.
We thus reduce Ring and Module instances as follows:
\begin{itemize}
  \item RLWE$_{n, q, m, \chi} \longrightarrow$ LWE$_{n, q, m \cdot n, \chi}$
  \item MLWE$_{n, d, q, m, \chi} \longrightarrow$ LWE$_{n \cdot d, q, m \cdot n, \chi}$
  \item RSIS$_{n, q, m, \beta} \longrightarrow$ SIS$_{n, q, m \cdot n, \beta}$
  \item MSIS$_{n, d, q, m, \beta} \longrightarrow$ SIS$_{n \cdot d, q, m \cdot n, \beta}$
\end{itemize}
Note that in the Ring and Module variants $n$ denotes the degree of the polnomial of the underlying Ring, %TODO: correct?
while in the standard variant, $n$ denotes the dimension of the secret. 
  
  







% TODO: replace "hardness" with "complexity of solving"?
\chapter{Algorithms and Estimates}
\input{algorithms-estimates.tex}


\section{Tool}
class for distributions... from section this modelling, problems, generic search... Überblick, wie verwendbar,
automatische norm umwandlung,
sonstige features

\subsection{Runtime and Cost Comparison}
defaults...
schnellste, beste => effizient, etc. parallel... problem reductions...



\chapter{Usage Examples}
\section{Two Problem Search}
basiert auf [BDLOP18]
\section{TODO: find other schemes to apply}


\chapter{Conclusion}

\printbibliography

All links were last followed on October 1, 2021.

%\appendix

\pagestyle{empty}
\renewcommand*{\chapterpagestyle}{empty}
\Versicherung
\end{document}