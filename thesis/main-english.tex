% !TeX spellcheck = en-US
% !TeX encoding = utf8
% !TeX program = pdflatex
% !BIB program = biber
% -*- coding:utf-8 mod:LaTeX -*-


% vv  scroll down to line 200 for content  vv


\let\ifdeutsch\iffalse
\let\ifenglisch\iftrue
\input{pre-documentclass}
\documentclass[
  % fontsize=11pt is the standard
  a4paper,  % Standard format - only KOMAScript uses paper=a4 - https://tex.stackexchange.com/a/61044/9075
  twoside,  % we are optimizing for both screen and two-side printing. So the page numbers will jump, but the content is configured to stay in the middle (by using the geometry package)
  bibliography=totoc,
  %               idxtotoc,   %Index ins Inhaltsverzeichnis
  %               liststotoc, %List of X ins Inhaltsverzeichnis, mit liststotocnumbered werden die Abbildungsverzeichnisse nummeriert
  headsepline,
  cleardoublepage=empty,
  parskip=half,
  %               draft    % um zu sehen, wo noch nachgebessert werden muss - wichtig, da Bindungskorrektur mit drin
  draft=false
]{scrbook}
\input{config}


\usepackage[
  title={A Tool for the Estimation of Lattice Parameters},
  author={Nicolai Krebs},
  type=bachelor,
  institute=sec, % or other institute names - or just a plain string using {Demo\\Demo...}
  course={Informatik, B.Sc.},
  examiner={Prof.\ Dr.\ Ralf Küsters},
  supervisor={Marc Rivinius,\ M.Sc.},
  startdate={April 22, 2021},
  enddate={October 22, 2021}
]{scientific-thesis-cover}

\input{acronyms}

\makeindex

\begin{document}

%tex4ht-Konvertierung verschönern
\iftex4ht
  % tell tex4ht to create picures also for formulas starting with '$'
  % WARNING: a tex4ht run now takes forever!
  %\Configure{$}{\PicMath}{\EndPicMath}{}
  %$ % <- syntax highlighting fix for emacs
  \Css{body {text-align:justify;}}

  %conversion of .pdf to .png
  \Configure{graphics*}
  {pdf}
  {\Needs{"convert \csname Gin@base\endcsname.pdf
      \csname Gin@base\endcsname.png"}%
    \Picture[pict]{\csname Gin@base\endcsname.png}%
  }
\fi

%\VerbatimFootnotes %verbatim text in Fußnoten erlauben. Geht normalerweise nicht.

\input{commands}
\pagenumbering{arabic}
\Titelblatt

%Eigener Seitenstil fuer die Kurzfassung und das Inhaltsverzeichnis
\deftriplepagestyle{preamble}{}{}{}{}{}{\pagemark}
%Doku zu deftriplepagestyle: scrguide.pdf
\pagestyle{preamble}
\renewcommand*{\chapterpagestyle}{preamble}



%Kurzfassung / abstract
%auch im Stil vom Inhaltsverzeichnis
\ifdeutsch
  \section*{Kurzfassung}
\else
  \section*{Abstract}
\fi

<Short summary of the thesis>

\cleardoublepage


% BEGIN: Verzeichnisse

\iftex4ht
\else
  \microtypesetup{protrusion=false}
\fi

%%%
% Literaturverzeichnis ins TOC mit aufnehmen, aber nur wenn nichts anderes mehr hilft!
% \addcontentsline{toc}{chapter}{Literaturverzeichnis}
%
% oder zB
%\addcontentsline{toc}{section}{Abkürzungsverzeichnis}
%
%%%

%Produce table of contents
%
%In case you have trouble with headings reaching into the page numbers, enable the following three lines.
%Hint by http://golatex.de/inhaltsverzeichnis-schreibt-ueber-rand-t3106.html
%
%\makeatletter
%\renewcommand{\@pnumwidth}{2em}
%\makeatother
%
\tableofcontents

% Bei einem ungünstigen Seitenumbruch im Inhaltsverzeichnis, kann dieser mit
% \addtocontents{toc}{\protect\newpage}
% an der passenden Stelle im Fließtext erzwungen werden.

\listoffigures
\listoftables

%Wird nur bei Verwendung von der lstlisting-Umgebung mit dem "caption"-Parameter benoetigt
%\lstlistoflistings
%ansonsten:
\ifdeutsch
  \listof{Listing}{Verzeichnis der Listings}
\else
  \listof{Listing}{List of Listings}
\fi

%mittels \newfloat wurde die Algorithmus-Gleitumgebung definiert.
%Mit folgendem Befehl werden alle floats dieses Typs ausgegeben
\ifdeutsch
  \listof{Algorithmus}{Verzeichnis der Algorithmen}
\else
  \listof{Algorithmus}{List of Algorithms}
\fi
%\listofalgorithms %Ist nur für Algorithmen, die mittels \begin{algorithm} umschlossen werden, nötig

% Abkürzungsverzeichnis
\printnoidxglossaries

\iftex4ht
\else
  %Optischen Randausgleich und Grauwertkorrektur wieder aktivieren
  \microtypesetup{protrusion=true}
\fi

% END: Verzeichnisse


% Headline and footline
\renewcommand*{\chapterpagestyle}{scrplain}
\pagestyle{scrheadings}
\pagestyle{scrheadings}
\ihead[]{}
\chead[]{}
\ohead[]{\headmark}
\cfoot[]{}
\ofoot[\usekomafont{pagenumber}\thepage]{\usekomafont{pagenumber}\thepage}
\ifoot[]{}


%% vv  scroll down for content  vv %%































%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Main content starts here
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Introduction}

- rise of quantum computing (short history)
  * conceptual
  * reality

- problem: some hard classical problems no longer hard
  * Shor's Algorithm (Peter Shor, 1994) %Sho97
    => quantum computers can solve the factoring and the discrete logarithm problem in polynomial time
  * application to encryption
  * overview of current encryption methods that will become insecure

- one solution (among hash-based, code-based, isogeny-based, and multivariate): lattice crypto
  * overview over history and capability of lattice crypto
  * advantages: good (quasilinear) asymptotic key sized, good concrete runtimes and key sizes, worst-case secure instantiations, advanced cryptographic primitives previously infeasible
  * including intro to LWE/SIS and applications to build crypto systems
    . SIS: signature schemes, hash functions
    . LWE: ``cryptomania'' applications (PKE, ...), signature schemes, lines:
      - cryptographic applications
      - establishing theoretical and asymptotic hardness \cite{Reg05} % ? Check
        \cite{BLPRS13, MP13} 
      - concrete hardness of LWE: attacks, runtime estimates, 
  * briefly outline concept and benefits of hard-case to average-case reductions

- purpose of this thesis
  * building schemes: need realistic hardness estimates of schemes for given parameter settings
  * lack in the past: no unified/easy to use tool => thesis aims to solve this problem
    tool we call \textit{Lattice Parameter Estimation} 

- overview of chapters/how to read



\chapter{Preliminaries} \label{chap:Preliminaries}

\section{Notation}
In the following, we denote vectors by bold lower-case letters like $\textbf{v}$ and matrices by bold upper-case letters $\textbf{M}$. Unless specified otherwise, $\| \cdot \|$ is the Euclidean norm. % TODO: anything else?


\section{Math} 
% TODO: some algebraic background?
\subsection{Norms and Bounds} % TODO: check
%TODO: write some prose about why we need that
Let $\mathcal{R}_q$ be a ring as defined in \cite{BDLOP18} and $f \in \mathcal{R}_q$ with $f = \sum_i f_i X^i$. We define the following norms \cite{BDLOP18}:
\begin{align}
  \mathcal{l}_1 : \| f| \|_1 &= \sum_i |f_i|\\
  \mathcal{l}_2 : \| f| \|_2 &= \left(\sum_i |f_i|^2\right) ^{\frac{1}{2}}\\
  \mathcal{l}_\infty : \| f| \|_\infty &= \max_i |f_i|
\end{align}

Then the following inequations hold \cite{BDLOP18}:
\begin{align}
  \| f \|_1 &\leq \sqrt{n} \| f \|_2 \label{norm1}\\
  \| f \|_1 &\leq n \| f \|_\infty \label{norm2}\\
  \| f \|_2 &\leq \sqrt{n} \| f \|_\infty \;\;(\text{since }  \sqrt{n} \| f \|_2 \leq n \| f \|_\infty) \label{norm3}\\
  \| f \|_\infty& \leq \| f \|_1 \label{norm4}
\end{align}

Let $\mathcal{O}_K$ be the ring of integers of a number field $K=\mathbb{Q}(\theta)$, where $\theta$ is an algebraic number and $\sigma$ denote the canonical embedding as defined in \cite{DPSZ12}. Then, for $x, y \in \mathcal{O}_K$ it holds the following inequations hold (we assume that $C_m$ in \cite{DPSZ12} is $1$) \cite{DPSZ12}. 
\begin{align}
  \| f \|_\infty &\leq \| \sigma(f) \|_\infty \label{norm5}\\
  \| \sigma(f) \|_\infty &\leq \| f \|_1 \label{norm6}
\end{align}

From the above inequations, we obtain the following norm transformations to $\mathcal{l}_p$-norms:
\begin{itemize}
  \item From \ref{norm1}, it follows that $\| f \|_1 \leq \sqrt{n} \| f \|_2$ and from \ref{norm2}, $\| f \|_1 \leq n \| f \|_\infty$.
  \item From \ref{norm3} and \ref{norm4}, it follows that $\| f \|_2 \leq \sqrt{n}  \| f \|_1$ and from \ref{norm3}, $\| f \|_2 \leq \sqrt{n}  \| f \|_\infty$.
  \item From \ref{norm4}, it follows that $\| f \|_\infty \leq  \| f \|_1$ and from \ref{norm1} and \ref{norm4}, $\| f \|_\infty \leq \sqrt{n}  \| f \|_2$.
  \item From \ref{norm6}, it follows that $\| \sigma(f) \|_\infty \leq  \| f \|_1$, from \ref{norm1} and \ref{norm6}, $\| \sigma(f) \|_\infty \leq \sqrt{n}  \| f \|_2$, and from \ref{norm2} and \ref{norm6}, $\| \sigma(f) \|_\infty \leq n  \| f \|_\infty$.
\end{itemize}

Likewise, we get the following transformations to the $\mathcal{C}_\infty$-norm:
\begin{itemize}
  \item From \ref{norm2} and \ref{norm5}, it follows that $\| f \|_1 \leq  n \| \sigma(f) \|_\infty$.
  \item From \ref{norm3} and \ref{norm5}, it follows that $\| f \|_2 \leq  \sqrt{n} \| \sigma(f) \|_\infty$.
  \item From \ref{norm5}, it follows that $\| f \|_\infty \leq  \| \sigma(f) \|_\infty$.
\end{itemize}

Let $f$ be defined as above and let $g \in \mathcal{R}_q$ where $g = \sum_i \overline{g}_i X^i$ where $g_i \in \left[-(q-1)/2, (q-1)/2\right]$ and $\overline{g}_i = g_i \mod q$ as in \cite{BDLOP18}. Then, we can define the following inequations for multiplication according to \cite{BDLOP18}:

\begin{itemize}
  \item If $\|f\|_\infty \leq \beta, \|g\|_1 \leq \gamma$ then $\|f \cdot g\|_\infty \leq \beta \cdot \gamma$.
  \item If $\|f\|_2 \leq \beta, \|g\|_2 \leq \gamma$ then $\|f \cdot g\|_\infty \leq \beta \cdot \gamma$.
\end{itemize}

Let $x, y \in \mathcal{O}_K$. Again, we assume that $C_m = 1$. Then, the following inequation holds according to \cite{DPSZ12}:
\begin{align}
  \| x \cdot y \|_\infty \leq C_m \cdot n^2 \cdot \| x \|_\infty \cdot \| y \|_\infty\\
  \| \sigma(x \cdot y) \|_\infty \leq  \| \sigma(x) \|_\infty \cdot \| \sigma(y) \|_\infty.
\end{align}



\subsection{lattice}
- background and history % TODO: from lecture -> change!!!
  * Birhoff [Bir40]
  * cryptoanalysis [LLL82]
  * cryptosystems [Atj96, HPS98]
  * [MR04]
  * LWE, assumption: worst-case lattice problems are hard [Reg05]
  * fully homomorphic [Gen09]
  * BGV scheme [BV11, BGV12]
  * tools [LPR10, LPR13] ideal latties, RLWE

- math % TODO: rewrite or \cite{Gop16}
  * lattice $\Lambda$ % TODO: check all n/m's
    - discrete additive subgroup of $\mathbb{R}^m$ % define discrete and additive subgroup?
    - Let $\textbf{b}_1, ..., \textbf{b}_n \in \mathbb{R}^m$ be a set of linearly independent basis vectors and $\textbf{B} = \left[\textbf{b}_1, ..., \textbf{b}_n\right] \in \mathbb{R}^{m\times n}$ be the corresponding basis with column vectors $\textbf{b}_i$
    - $n$ is the dimension of the Lattice
    - $\Lambda(\textbf{B})$ defined by all integer combinations of elements of $\textbf{B}$:
    \begin{equation}
      \Lambda(\textbf{B}) = \left\{ x \in \mathbb{R}^m \mid \exists \alpha_1, ..., \alpha_n \in \mathbb{Z} : \textbf{x} = \sum_{i=1}^n \alpha_i \textbf{b}_i \right\}
    \end{equation} 
    % TODO: show example plot
    - full-ranked lattice: dimension is maximal, $m$
    - basis $\textbf{B}$ is not unique -> let $\textbf{U}\in \mathbb{Z}^{n\times n}$ be a modular matrix (determinant is $\pm1$), then $\textbf{B}\cdot \textbf{U}$ is also a basis of the $\Lambda$ ($\textbf{U} \cdot \mathbb{Z}^{n} = \mathbb{Z}^{n}$) -> different basis for the same lattice $\Lambda$
    - lattice coset:
      quotient group $\mathbb{R}^n/\Lambda$ of cosets
      \begin{equation*}
        \textbf{c} + \Lambda = {\textbf{c} + \textbf{v} \mid v \in \Lambda}
      \end{equation*}
      with $\textbf{c} \in \mathbb{R}^n$ % TODO: maybe add plot
    - fundamental domain: subset of $\mathbb{R}^m$ containing exactly one representative of every coset
    - fundamental parallelipiped: $\textbf{B} \cdot [ - 1/2, 1/2)^n$ every coset has representative  % c - B * \left\lfloor^{-1} \cdot c\right\rceil
    % TODO: maybe add plot
    - determinant of a full-ranked lattice $\Lambda(\textbf{B})$
    \begin{equation}
      \det(\Lambda(\textbf{B})) = \mid \det(\textbf{B})\mid
    \end{equation}
      is well-defined (independent from basis) => volume of fundamental domain % TODO define
      can be generalized to not full-ranked => $\det(\Lambda(\textbf{A})) = \sqrt{\det(\textbf{A}^\perp \textbf{A})}$
  * minimum distance of $\lambda_1(\Lambda)$ of a lattice is the length of its shortest nonzero vector, i.e. $\lambda_1(\Lambda) \min_{v \in \Lambda \setminus \{0\}}$
  * $i$th successive minimum $\lambda_i(\Lambda)$
    - smallest radius $r$ such that $\Lambda$ has $i$ linearly independent lattice vectors of norm at most $r$
    - in general hard to calculate $\lambda_i(\Lambda(\textbf{B}))$ for a given basis  
  % * Gaussian heuristic: 
  %   - estimate length of shortest lattice vactor in $n$-dimensional lattice $Lambda$, i.e. estimate $\lambda_1(\Lambda)$ given $\det{\Lambda}$
  %   \begin{equation}
  %     \lambda_1{\Lambda} \approx \frac{\Gamma(1 + n/2)^{1/n}}{\sqrt{\pi}} \det(\Lambda)^{1/n}
  %   \end{equation}
  * 
  * modular integer (or $q$-ary) lattices % \cite{MR09}
    - full-ranked lattice $\Lambda$ such that $q\mathbb{Z}^m \subseteq	\Lambda \subseteq	\mathbb{Z}^m$ given $q \in \mathbb{N}$
    - can be specified in two ways by matrix $\textbf{A} \in \mathbb{Z}_q^{m\times n}$:
    \begin{equation}
      \Lambda_q(\textbf{A}) = \left\{ x \in \mathbb{Z}^m \mid \exists y \mathbb{Z}^n : \textbf{x} = \textbf{A}\textbf{y} \mod q \right\}
    \end{equation}
    or
    \begin{equation}
      \Lambda_q^\perp(\textbf{A}) = \left\{ x \in \mathbb{Z}^m \mid  \textbf{A}\textbf{x} = 0 \mod q \right\}
    \end{equation}
    - finding a short vector in $\Lambda_q(\textbf{A})$ corresponds to LWE % TODO check
    - finding short vectors in $\Lambda_q^\perp(\textbf{A})$ corresponds to SIS % TODO check \cite{Reg10}
    - easy to find basis of $\Lambda_q(\textbf{A})$ \cite{AFG13}
    - with high probability determinant of $q$-ary lattice is $\det(\Lambda_q(\textbf{A}))=q^{m-n}$ if $\textbf{A} \in \mathbb{Z}_q^{m\times n}$

  * Gram-Schmidt basis
    - set of column vectors $\textbf{B} \in \mathbb{Z}_q^{m\times n}$, $\pi_{\text{span}(\textbf{B})}(\textbf{t})$ for projection of vector $\textbf{t}$ unto span of vectors of $\textbf{B}$
    - $\pi_{\text{span}(\textbf{B})}(\textbf{t}) = \textbf{B}(\textbf{B}^\perp \textbf{B})^{-1}\textbf{B}^T \cdot \textbf{t}$
    - Gram-Schmidt orthogonalization $\tilde{\textbf{B}} = \left\{\tilde{\textbf{b}}_1, ..., \tilde{\textbf{b}}_n\right\}$ of basis $\textbf{B}$: $\tilde{\textbf{b}}_i = \textbf{b}_i - \pi_{\text{span}(\textbf{b}_1, ..., \textbf{b}_{i-1})}(\textbf{b}_i)$ for $i \in \{1, ..., n\}$ 
    % Alternative:
    Let $\textbf{B} = \left[\textbf{b}_1, ..., \textbf{b}_n\right], \textbf{b}_i \in \mathbb{Z}_q^{m}$ be a basis. Define $\tilde{\textbf{b}}_i$ as follows: $\tilde{\textbf{b}}_1 = \textbf{b}_1$. For $i \in \{2, ..., n\}$ let $\tilde{\textbf{b}}_i$ be the projection of $\textbf{b}_i$ to the vector that is orthogonal to the span of $\{\textbf{b}_1, ..., \textbf{b}_{i-1}\}$. Then,  $\tilde{\textbf{B}} = \left[\tilde{\textbf{b}}_1, ..., \tilde{\textbf{b}}_n\right]$ is called the Gram-Schmidt orthogonalization of basis $\textbf{B}$ where $\| \tilde{\textbf{b}}_i\| \leq \| \textbf{b}_i\|$. 

  
  * dual of a lattice is "the set of points whose inner products with the vectors in the lattice are integers" $\Lambda$: $\Lambda^{\perp} := \{ \textbf{w} \mid \langle \textbf{w}, \Lambda \rangle \subset \mathbb{Z}\}$
    
    
  * smoothing lemma
    

- Lattice problems
  * Minkowski theorem: Let $\Lambda$ be a lattice of dimension $n$, then $\lambda_1 \leq \sqrt{n} \cdot (\det \Lambda)^{\frac{1}{n}}$
  * Lattice reduction: find short basis compared to $\lambda_1(\Lambda)$ and 
  * SVP: given a basis $\textbf{B}$ of lattice $\Lambda$ find shortest nonzero lattice vector =>  $v\in \Lambda$ s.t. $\| v \| = \lambda_1(\Lambda)$
  * SVP$_\gamma$: given a basis $\textbf{B}$ of lattice $\Lambda$ find  $v\in \Lambda$ s.t. $0 < \| v \| \leq \gamma \lambda_1(\Lambda)$
  * $\alpha$-Approximate SVP: vector of length $\alpha \lambda_1$
  * \textsc{GapSVP}$_\gamma$ (decision version of \textsc{SVP}): "given basis $\textbf{B}$ of $n$-dimensional lattice $\Lambda$ with either $\lambda_1{\Lambda} \leq 1$ or $\lambda_1{\Lambda} \geq \gamma(n)$, decide which is the case" %\cite{Pei16}
  * CVP$_\gamma$: given  basis $\textbf{B}$ of $n$-dimensional lattice $\Lambda$ and target $\textbf{t}\in\mathbb{R}^n$ find point in lattice that is close to $\textbf{t}$ => find  $\textbf{v} \in \mathbb{R}^n$ with $\|\textbf{t} - \textbf{v}\| < \gamma \min_{\textbf{v}' \in \Lambda} \|\textbf{v}' - \textbf{v}\|$
  * \textsc{SIVP} (shortest independent vector problem): given  basis $\textbf{B}$ of $n$-dimensional lattice $\Lambda$, find $n$ linearly independent lattice vectors $\textbf{v}_1, ..., \textbf{v}_n \in \Lambda(\textbf{B})$ such that $\max_i \|\textbf{v}_i\|$ for $i \in \{1, ..., n\}$ is minimal
  * BDD$_\gamma$: given basis $\textbf{B}$ of $n$-dimensional lattice $\Lambda$ and target $\textbf{t}\in\mathbb{R}^n$ with $\text{dist}(\textbf{t}, \Lambda) < d ) \lambda_1(\Lambda)/(2\gamma(n))$, find unique lattice vector $\textbf{v} \in \Lambda$ such that $\|\textbf{t} - \textbf{v} \| < d$ %\cite{Pei16}
  * ideal lattice (do I need that?)
  * ...?
  * eher die Sachen für LWE/SIS als die Sachen für Algorithmen (analog Vorlesung), evtl. 
  
  Intuition für die anderen Sachen...
  Solving SVP with approximation factors: % where to put???
        - 1 => NP-hard \cite{Ajt98}
        - $\tilde{O}(n)$ => OWF \cite{Ajt96, MR04}
        - $2^{n \log \log n / \log n}$ and $2^{n/2}$ in Poly-time \cite{LLL82}
        => best known $2^k$-approx in $2^{\tilde{O}(n/k)}$ time (even quantum!)


\subsection{distributions}

  - Gaussian, def, component-wise, trafo to bound % TODO: GPV08, or LS15
    * definition
      discrete Gaussian distribution over $q$-ary lattice $\Lambda$ with Gaussian width parameter $s > 0$ and center $\textbf{c}$, denoted by $D_{\Lambda, s, \textbf{c}}$: probability of sampling a vector $\textbf{x}\in \Lambda$ is proportional to $e^{-\pi \|\textbf{x} - \textbf{c}\|^2/s^2}$ % \cite{Reg10, GPV08} or "probability distribution that assigns mass proportional to ... to each point $\textbf{x}\in \Lambda$"
      In order to avoid confusion, throughout this work and in the \textit{Lattice Parameter Estimation} we use $\sigma$ to denote the standard deviation, where $\sigma = \frac{s}{\sqrt{2 \pi}}$, and define $\alpha := \frac{s}{q} = \frac{\sqrt{2\pi} \sigma}{q}$. 
    * %TODO better definition in GPV08 => different definition needed for LWE???
    * %TODO how to do this? => variant of Babai's ``nearest-plane'' algorithm, see GPV08

    * component-wise
    

    For some applications, we receive a Gaussian distribution as input, but require a bound in some norm in order to estimate the hardness of SIS. Hence, we need to transform the Gaussian width parameter into a bound $\beta$ given some security parameter $\text{sec}$. Note that a $n$-dimensional Gaussian can be sampled by sampling $n$ independent 1-dimensional Gaussians. %TODO reformulate
        
    For a Gaussian distribution, the following holds: 
    
    \begin{equation}
      \text{Pr}\left[ |X| \geq \beta \right] \leq 2 e^{-\pi \beta^2/s^2}
    \end{equation}
    
    We demand $2 e^{-\pi \beta^2/s^2} \approx 2^{-sec}$, hence
    
    \begin{align*}
      2 e^{-\pi \beta^2/s^2} &\approx 2^{-sec}\\
      -\pi \frac{\beta^2}{s^2} &\approx (-sec - 1)\ln (2)\\
      \beta  &\approx s \sqrt{\frac{(sec + 1) \ln(2)}{\pi}}
    \end{align*}

    
    
    * smoothing factor? 
    * Uniform (stuff I use in tool)







\section{LWE and SIS}
Applications: SIS can be used for one-way functions and collision-resistant hasing. LWE can be used to build pseudo-random number generators, public-key encryption schemes and oblivious transfer and secure MPC. Lattice Trapdoors (trapdoor functions, digital signatures)? Punctured Trapdoors (identity-based encryption, attribute-based encryption, predicate encryption)? % TODO: from https://www.youtube.com/watch?v=LlPXfy6bKIY see below for more detail

\subsection{LWE}
Following based on \cite{Reg10}:% TODO: change or quote 

Introduced by Regev in \cite{Reg09}
Origin: work of Ajtai and Dwork \cite{AD97}, first public-key cryptosystem based on worst-case lattice problems, simlifications/improvements \cite{GGH97b, Reg03} imply hardness result for LWE. 
Early work: hardness based on unique-SVP, Peikert \cite{Pei09} and Lyubashevsky and Micciancio \cite{LM09} show that unique-SVP is essentially equivalent to \textsc{GapSVP}.

- ´cryptomania´ applications: public-key encryption schemes under chosen-plaintext attacks \cite{Reg05, KTX07, PVW08}, and chosen-ciphertext attacks \cite{PW08, Pei09}, oblivious transfer protocoles \cite{PVW08}, identity-based encryption (IBE) schemes \cite{GPV08, CHKP10, ABB10}, leakage-resilient encryption \cite{AGV09, ACPS09, DGKPV10, GKPV10}, and more % TODO change or \cite{Reg10}
- most important: fully homomorphic encryption schemes \cite{Gen09a, BV11, Bra12, GSW13} % TODO 

Intuition: "recover $\textbf{s} \in \mathbb{Z}_q^n$ given sequence of ´approximate´ random linear equations on $\textbf{s}$" 

Formal Definition: 
\begin{definition}[LWE Distribution \cite{Reg10}] %TODO
  For $n \geq 1$, modulus $q \geq 2$, error distribution $\chi$ on $\mathbb{Z}_q$, and a fixed secret vector $\textbf{s}$, let $\mathcal{A}_{\textbf{s}, \chi}$ be the probability distribution over $\mathbb{Z}_q^n \times \mathbb{Z}_q$ by choosing a vector $\textbf{a} \in \mathbb{Z}_q^n$ uniformly at random, $e \in \mathbb{Z}_q$ according to $\chi$ and returning pairs of $(\textbf{a}, \langle \textbf{a}, \textbf{s} \rangle + e)$.
\end{definition}

For $m$ samples, we obtain the output $(\textbf{A}, \textbf{s}^\perp \textbf{A} + e^\perp)$. Additions are performed in $\mathbb{Z}_q$. We say that an algorithm solves LWE with modulus $q$ and error distribution $\chi$ if, for any $\textbf{s} \in \mathbb{Z}_q^n$, given an arbitrary number of independent samples from $\mathcal{A}_{\textbf{s}, \chi}$ it outputs $\textbf{s}$ (with high probability). For $q=2$ corresponds to \textit{learning parity with noise} (LPN) problem.

% TODO matrix Schreibweise vs nicht matrix schreibweise
% TODO Define Search/Decision LWE? 
\begin{definition}[Search-LWE$_{n, q, m, \chi}$]
  Search-LWE$_{n, q, m, \chi}$ asks for the recovery of the secret vector $\textbf{s}$ given $m$ samples % TODO
\end{definition}

\begin{definition}[Decision-LWE$_{n, q, m, \chi}$]
  Given $m$ samples, Search-LWE$_{n, q, m, \chi}$ asks to distinguish whether the samples were drawn from  $\mathcal{A}_{\textbf{s}, \chi}$ or from a uniform distribution on $\mathbb{Z}_q^n \times \mathbb{Z}_q$.
\end{definition}

% TODO parameter choice: often prime q \in poly(n), \chi has mean zero and \sigma = \alpha \cdot q for some small \alpha, e.g. Regev: q \approx n^2, \alpha = 1/(\sqrt{2\pi n} \cdot \log_2^2 n)



Solving LWE corresponds to solving the \textit{Bounded Distance Decoding problem} (BDD) in the lattice $\Lambda(\textbf{A}) = \{ \textbf{s}^{T} \cdot A \mid \textbf{s} \in \mathbb{Z}_q^n\} + q \mathbb{Z}^m$, where the $m$ columns of $\textbf{A}$ are randomly uniform vectors $\textbf{a}_i \in \mathbb{Z}_q^n$. %TODO: from https://www.youtube.com/watch?v=LlPXfy6bKIY

Best algorithm to solve LWE: Blum, Kalai, and Wasserman \cite{BKW03} with $2^{O(n)}$ samples and time. % TODO Sketch BKW?

Hardness: best algorithm exponential, extension of LPN (LPN believed to be hard), hard assuming worst-case hardness of \textsc{GapSVP} % TODO make sure that is correct
and \textsc{SIVP} \cite{Reg05, Pei09}. More details? Different cases for $q$ exponential/polynomial, approximation factors...
Hardness based on worst-case lattice problems => strong security guarantees, such as conjectured security against quantum computers...
 
Search to decision reduction => distiguishing is LWE samples from uniform samples sufficient, worst-case to average-case reduction => sufficient to solve distinguishing for uniform secret

\subsection{Short Integer Solution (SIS)}
The dual problem to LWE is the \textit{Short Integer Solution problem} (SIS).

- principle: given a set of set of uniformly random vectors $\textbf{a}_1, ..., \textbf{a}_m \in \mathbb{Z}_q^n$ find a subset of them or combination with small coefficients that sums to zero (modulo $q$). % TODO change or \cite{Reg10}
- introduced in \cite{MR04}, origins in \cite{Atj96}, used for ´minicrypt´ primitives: one-way functions \cite{Atj96}, collision resistant hash functions \cite{GGH96}, digital signature schemes \cite{GPV08, CHKP10}, and identification schemes \cite{MV03, Lyu08, KTX07} % TODO change or \cite{Reg10}

\begin{definition}[SIS Problem (Adapted from [\citealp{LS15}, Definition 3.1])]
  The problem \text{SIS}$_{n, q, m, \beta}$ is defined as follows: Given a uniformly random matrix $\textbf{A}^{n\times m}$, find a vector $\textbf{s} \in \mathbb{Z}_q^m$ such that $\textbf{A} \cdot \textbf{s} = 0 \; \text{mod } q$ and $0 < \| \textbf{s}\| \leq \beta$.
\end{definition}

Finding such a vector corresponds to finding a short lattice vector in costets of the lattice $\Lambda^{\perp}(\textbf{A}) = \{ y \mid \textbf{A} \cdot y \mod q \}$ % TODO get source other than https://www.youtube.com/watch?v=LlPXfy6bKIY

Hardness: for any poly-bounded $m, \beta$ and for ``large enough'' prime $q$: SIS$_{n, q, m, \beta}$ is as hard as worst-case approx-SIVP (and \textsc{GapSVP}) to within $\beta \cdot \tilde{O}(\sqrt{n})$ factor 

\subsection{Ring and Module Variants} 
- problem key sizes in LWE/SIS in $O(n^2)$ (matrix $\textbf{A} \in \mathbb{Z}_q^{m \times n})$, where $m \in \Omega(n)$)% TODO change or \cite{Reg10}
- idea: introduce some sort of a structure in samples: $n$ power of two, $\textbf{a}$ vectors in groups of size $n$, for each group $\textbf{a}_1 = (a_1, ..., a_n)$, $a_i$ are uniformly random in $\mathbb{Z}_q$, and $\textbf{a}_i = (a_i, ..., a_n, -a_1, ..., -a_{i-1})$. Hence, $n$ vectors only need $O(n)$ memory, also speedups in operations by using FFT % TODO change or \cite{Reg10}
- formally: vectors are elements of the ring $\mathbb{Z}_q\left[x\right] / \left\langle x^n + 1 \right\rangle$ which we call $\mathcal{R}_q$ instead of the group $\mathbb{Z}_q^n$, $n$ power of two ensures that $x^n + 1$ is irreducible over the rationals% TODO change or \cite{Reg10}
- %TODO add more?

\begin{definition}[Ring-SIS Problem [\citealp{LS15}, Definition 3.3])]
  The problem \text{RSIS}$_{n, q, m, \beta}$ is defined as follows: Given $a_1, ..., a_n \in \mathcal{R}_q$ chosen independently from the uniform distribution, find $s_1, ..., s_n \in \mathcal{R}$ such that $\sum_{i=1}^m a_i \cdot s_i = 0 \mod q$ and $0 < \| \textbf{s}\| \leq \beta$, where $\textbf{s} = (s_1, ..., s_m)^T \in \mathcal{R}^m$.
\end{definition} % TODO: need n? say sth more about n power of 2?
% TODO: matrix version?

\begin{definition}[Module-SIS Problem [\citealp{LS15}, Definition 3.3])]
  The problem \text{MSIS}$_{n, d, q, m, \beta}$ is defined as follows: Given $a_1, ..., a_n \in \mathcal{R}_q^d$ chosen independently from the uniform distribution, find $s_1, ..., s_n \in \mathcal{R}$ such that $\sum_{i=1}^m a_i \cdot s_i = 0\mod q$ and $0 < \| \textbf{s}\| \leq \beta$, where $\textbf{s} = (s_1, ..., s_m)^T \in \mathcal{R}^m$.
\end{definition} % TODO: need n? say sth more about n power of 2?
% TODO: matrix version?

% TODO: LWE

While there exist special cases where the Ring structure of problem instances can be exploited in an attack on LWE or SIS, % TODO: find examples
in general, the hardness of Ring and Module variants is estimated by interpreting the coefficients of elements of $\mathcal{R}_q$ as vectors in $\mathbb{Z}_q^n$ \cite{ACDDPPVW18}.
We thus reduce Ring and Module instances as follows:
\begin{itemize}
  \item RLWE$_{n, q, m, \chi} \longrightarrow$ LWE$_{n, q, m \cdot n, \chi}$
  \item MLWE$_{n, d, q, m, \chi} \longrightarrow$ LWE$_{n \cdot d, q, m \cdot n, \chi}$
  \item RSIS$_{n, q, m, \beta} \longrightarrow$ SIS$_{n, q, m \cdot n, \beta}$
  \item MSIS$_{n, d, q, m, \beta} \longrightarrow$ SIS$_{n \cdot d, q, m \cdot n, \beta}$
\end{itemize}
Note that in the Ring and Module variants $n$ denots the degree of the polnomial of the underlying Ring, %TODO: correct?
while in the standard variant, $n$ denots the dimension of the secret. 
  
  







% TODO: replace "hardness" with "complexity of solving"?
\chapter{Algorithms and Estimates}


\section{Lattice Basis Reduction} % perhaps move to Algorithms
- measure quality of basis: Hermite factor  % TODO change or \cite{Reg10}
  * basis $\textbf{B} = \left\{\textbf{b}_1, ..., \textbf{b}_m\right\}$, $m$-dimensional lattice $\Lambda(\textbf{B})$ has Hermite factor $\delta$ if
  \begin{equation} \label{eq:hermite}
    \| \textbf{b}_1 \| \approx \delta^m \det(\Lambda)^{1/m}
  \end{equation}
  * use Geometric Series Assumption (GSA) to obtain estimates for $\textbf{b}_i$: % TODO: necessary?
    \begin{equation} \label{eq:GSA}
      \| \tilde{\textbf{b}}_i \| \approx \alpha^{i-1} \| \textbf{b}_1 \|
    \end{equation}
    for $0 < \alpha < 1$
    \ref{eq:hermite} into \ref{eq:GSA} -> $\| \tilde{\textbf{b}}_i \| \approx \alpha^{i-1} \delta^m \det(\Lambda)^{1/m}$
    with $\prod_{i-1}^m \| \tilde{\textbf{b}}_i \| = \det(\Lambda)$ we get 
    \begin{align*}
      &\quad& \prod_{i-1}^m \| \tilde{\textbf{b}}_i \| &\approx \prod_{i-1}^m \alpha^{i-1} \delta^m \det(\Lambda)^{1/m} \\
      \Leftrightarrow&\quad& \det(\Lambda) &\approx \delta^{2m} \det(\Lambda) \prod_{i-1}^m \alpha^{i-1}\\
      \Leftrightarrow&\quad& \delta^{-m^2}  &\approx \alpha^{\frac{m(m-1)}{2}}\\
      \Leftrightarrow&\quad& \delta^{-2}  &\approx \alpha^{(m-1)/m}\\
    \end{align*}
    Hence, $alpha \approx \delta^{-2}$ and 
    \begin{equation}
      \| \tilde{\textbf{b}}_i \| \approx \delta^{-2(i-1) + m} \det(\Lambda)^{1/m}
    \end{equation}
  * good basis -> first Gram-Schmidt vectors become shorter (latter longer)
  * $\delta = 1.01$ feasible, $\delta = 1.007$ seems infeasible for now
  * gap between provable and experimental cost estimate to reach some hermite $\delta$ => provable results only give upper bounds, for practical security we need lower bound => combine theoretical results with experimental results
  * well-established estimate \cite{LP11}




\subsection{Cost Models for Lattice Reduction}
Just insert a table and reference somewhere else? Warum notwendig, wie kommt man darauf? ... alg laufen lassen, extrapolieren...


\section{LWE}
\subsection{Approaches}
\subsubsection{SIS}
rewrite LWE as the problem of finding short vector in dual lattice => SIS
\subsubsection{BDD}

lattice reduction algorithms solve SIS and BDD 
\subsubsection{Direct}

% TODO: based on GSJ15, rephrase
- algebraic approach Arora and Ge with subexponential complexity when $\sigma \leq \sqrt{n}$, else fully exponential, mainly of asymptotic interest (higher complexity than others)

- combinatorial algorithms: BKW as basis \cite{BKW03}, resembles generalized birthday approach by Wagner % Wagner, D.: A generalized birthday problem. In: Advances in cryptologyCRYPTO 2002, pp. 288304. Springer (2002)
originally for solving LPN, can be analyzed => explicit complexity for different LWE instances, theoretical analysis and actual performance close
very memory expensive (often same order as time complexity) 

\subsection{Algorithms in Estimator}
\subsubsection{Coded-BKW [GuoJohSta15]}
modified BKW step -> coded-BKWE step to cancel out more positions in the $\textbf{a}$ vectors than traditional BKW step
map part of $\textbf{a}$ vector into nearest codeword in lattice code (linear code over $\mathcal{Z}_q$, Euclidean distance)
introduces some noise, can be kept small by appropriate parameters
pair of $\textbf{a}$ vectors map to same codeword => add together to create new sample with part of $\textbf{a}$ vector cancelled
samples are input to next step in BKW procedure
additional steps using discrete FFT
slightly modified for BINARY-LWE (secret vector uniformly chosen from $\{0, 1\}^n$) greatly increases performance
\subsubsection{Dual Attack [MicReg09]}
\subsubsection{Decoding Attack [LinPei11]}
\subsubsection{Primal-uSVP [ADPS16, BaiGal14]}
\subsubsection{Meet-in-the-Middle [AlbPlaSco15]}
\subsubsection{Arora-Ge [AroGe11,ACFP14]}


\section{SIS}
\subsection{Dual Attack}
\subsubsection{MR variant [MR09]}
\subsubsection{RS variant [RS10]}
\subsection{Combinatorial Attack [MR09]}


\section{Tool}
class for distributions... from section this modelling, problems, generic search... Überblick, wie verwendbar
automatische norm umwandlung
sonstige features

\subsection{Runtime and Cost Comparison}
defaults...
schnellste, beste => effizient, etc. parallel... problem reductions...



\chapter{Usage Examples}
\section{Two Problem Search}
basiert auf [BDLOP18]
\section{TODO: find other schemes to apply}


\chapter{Conclusion}

\printbibliography

All links were last followed on October 1, 2021.

\appendix
\input{latexhints-english}

\pagestyle{empty}
\renewcommand*{\chapterpagestyle}{empty}
\Versicherung
\end{document}